# MiniBlog ç¯å¢ƒæ­å»ºæŒ‡å—

æœ¬æ–‡æ¡£æè¿°äº† MiniBlog é¡¹ç›®çš„å¼€å‘ç¯å¢ƒæ­å»ºè¿‡ç¨‹ã€‚æˆ‘ä»¬é‡‡ç”¨**æç®€è®¾è®¡**ï¼Œåªéœ€è¦ä¸€ä¸ª `docker-compose.env.yml` æ–‡ä»¶å³å¯å¯åŠ¨ MySQLã€Redisã€Kafka ç­‰æ‰€æœ‰åŸºç¡€æœåŠ¡ï¼Œæ— éœ€é¢å¤–çš„é…ç½®æ–‡ä»¶æˆ–è„šæœ¬ã€‚

## ğŸ“‹ ç¯å¢ƒè¦æ±‚

- **Docker**: 20.10 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Docker Compose**: 2.0 æˆ–æ›´é«˜ç‰ˆæœ¬  
- **ç³»ç»Ÿå†…å­˜**: è‡³å°‘ 4GB å¯ç”¨å†…å­˜
- **ç£ç›˜ç©ºé—´**: è‡³å°‘ 10GB å¯ç”¨ç£ç›˜ç©ºé—´
- **æ“ä½œç³»ç»Ÿ**: macOSã€Linux æˆ– Windows

> ğŸ’¡ **æç®€åŸåˆ™**: æ•´ä¸ªç¯å¢ƒåªéœ€è¦ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ— éœ€å­¦ä¹ å¤æ‚çš„ Makefile æˆ–è„šæœ¬å‘½ä»¤ã€‚

## ğŸ—ï¸ æœåŠ¡æ¶æ„

### æ ¸å¿ƒæœåŠ¡

| æœåŠ¡ | ç‰ˆæœ¬ | ç«¯å£ | è¯´æ˜ |
|------|------|------|------|
| MySQL | 8.0 | 3306 | ä¸»æ•°æ®åº“ |
| Redis | 7-alpine | 6379 | ç¼“å­˜æ•°æ®åº“ |
| Kafka | 7.4.0 | 9092 | æ¶ˆæ¯é˜Ÿåˆ— |
| Zookeeper | 7.4.0 | 2181 | Kafka åè°ƒæœåŠ¡ |

### å¯è§‚æµ‹æ€§ç»„ä»¶

| æœåŠ¡ | ç‰ˆæœ¬ | ç«¯å£ | è¯´æ˜ |
|------|------|------|------|
| Elasticsearch | 8.8.0 | 9200 | æ—¥å¿—å­˜å‚¨å¼•æ“ |
| Filebeat | 8.8.0 | - | æ—¥å¿—é‡‡é›†å™¨ |
| go-stash | latest | - | æ—¥å¿—å¤„ç†å™¨ |
| Prometheus | 2.44.0 | 9090 | æŒ‡æ ‡æ”¶é›†å™¨ |
| Grafana | 9.5.0 | 3000 | ç›‘æ§å¯è§†åŒ– |
| Jaeger | 1.46 | 16686 | é“¾è·¯è¿½è¸ª |

### ç®¡ç†ç•Œé¢

| æœåŠ¡ | ç«¯å£ | è®¿é—®åœ°å€ | ç”¨æˆ·å | å¯†ç  | è¯´æ˜ |
|------|------|----------|--------|------|------|
| Kafka UI | 8080 | <http://localhost:8080> | - | - | Kafka ç®¡ç†ç•Œé¢ |
| Kibana | 5601 | <http://localhost:5601> | - | - | æ—¥å¿—åˆ†æç•Œé¢ |
| Grafana | 3000 | <http://localhost:3000> | admin | admin123 | ç›‘æ§å¯è§†åŒ–ç•Œé¢ |
| Jaeger | 16686 | <http://localhost:16686> | - | - | é“¾è·¯è¿½è¸ªç•Œé¢ |
| Prometheus | 9090 | <http://localhost:9090> | - | - | æŒ‡æ ‡æŸ¥è¯¢ç•Œé¢ |

### æœåŠ¡é…ç½®ä¿¡æ¯

#### MySQL é…ç½®

- **æ•°æ®åº“å**: miniblog
- **ç”¨æˆ·å**: miniblog_user  
- **å¯†ç **: j478EaZGDNPUbnXb
- **Rootå¯†ç **: j478EaZGDNPUbnXb
- **å­—ç¬¦é›†**: utf8mb4
- **æ—¶åŒº**: Asia/Shanghai (+08:00)

#### Redis é…ç½®

- **å¯†ç **: weZ2014P89rlTuWe
- **å†…å­˜é™åˆ¶**: 256MB
- **å†…å­˜ç­–ç•¥**: allkeys-lru
- **æŒä¹…åŒ–**: AOF + RDB
- **æœ€å¤§è¿æ¥æ•°**: 10000

#### Kafka é…ç½®

- **è‡ªåŠ¨åˆ›å»ºä¸»é¢˜**: å¯ç”¨
- **åˆ é™¤ä¸»é¢˜**: å¯ç”¨
- **å¤åˆ¶å› å­**: 1ï¼ˆå•èŠ‚ç‚¹ï¼‰

#### å¯è§‚æµ‹æ€§é…ç½®

##### Elasticsearch é…ç½®

- **é›†ç¾¤æ¨¡å¼**: å•èŠ‚ç‚¹
- **å†…å­˜é™åˆ¶**: 512MB
- **å®‰å…¨è®¤è¯**: ç¦ç”¨ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
- **æ•°æ®æŒä¹…åŒ–**: å¯ç”¨

##### Grafana é…ç½®

- **ç®¡ç†å‘˜ç”¨æˆ·**: admin
- **ç®¡ç†å‘˜å¯†ç **: admin123
- **é¢„è£…æ’ä»¶**: grafana-piechart-panel
- **æ•°æ®æº**: Prometheus

##### Jaeger é…ç½®

- **æ”¶é›†å™¨åè®®**: HTTP/gRPC/UDP
- **OTLP æ”¯æŒ**: å¯ç”¨
- **å­˜å‚¨å¼•æ“**: Badgerï¼ˆæœ¬åœ°å­˜å‚¨ï¼‰

##### æ—¥å¿—æ”¶é›†é…ç½®

- **æ—¥å¿—ç›®å½•**: `deploy/dev/logs/`
- **Filebeat è¾“å‡º**: Elasticsearch + Kafka
- **go-stash å¤„ç†**: Kafka â†’ Elasticsearch

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä½¿ç”¨ Docker Composeï¼ˆç®€å•ç›´æ¥ï¼‰

âš ï¸ **é‡è¦ç½‘ç»œé…ç½®**:

- ä½¿ç”¨é¢„å…ˆåˆ›å»ºçš„å¤–éƒ¨ç½‘ç»œ `miniblog-network`
- åŸºç¡€ç¯å¢ƒæœåŠ¡å’Œåº”ç”¨æœåŠ¡éƒ½è¿æ¥åˆ°åŒä¸€ä¸ªå¤–éƒ¨ç½‘ç»œ
- `make env-start` ä¼šè‡ªåŠ¨åˆ›å»ºç½‘ç»œå¹¶å¯åŠ¨åŸºç¡€æœåŠ¡
- **å»ºè®®å…ˆå¯åŠ¨åŸºç¡€ç¯å¢ƒï¼Œå†å¯åŠ¨åº”ç”¨æœåŠ¡**

#### 1. å¯åŠ¨åŸºç¡€ç¯å¢ƒæœåŠ¡ï¼ˆå¿…é¡»å…ˆå¯åŠ¨ï¼‰

```bash
# è¿›å…¥é¡¹ç›®æ ¹ç›®å½•
cd miniblog-v3

# è¿›å…¥éƒ¨ç½²ç›®å½•
cd deploy/dev

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker compose -f docker-compose.env.yml up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker compose -f docker-compose.env.yml ps
```

#### 2. æœåŠ¡ç®¡ç†

```bash
# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker compose -f docker-compose.env.yml logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker compose -f docker-compose.env.yml logs mysql
docker compose -f docker-compose.env.yml logs redis
docker compose -f docker-compose.env.yml logs kafka

# é‡å¯æœåŠ¡
docker compose -f docker-compose.env.yml restart

# åœæ­¢æœåŠ¡
docker compose -f docker-compose.env.yml down

# åœæ­¢å¹¶åˆ é™¤æ•°æ®å·ï¼ˆå®Œå…¨æ¸…ç†ï¼‰
docker compose -f docker-compose.env.yml down -v
```

#### 3. é…ç½®éªŒè¯

```bash
# éªŒè¯é…ç½®æ–‡ä»¶è¯­æ³•
docker compose -f docker-compose.env.yml config

# æ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸å¯åŠ¨
docker ps
```

## ğŸ” æœåŠ¡è¿æ¥ä¸æµ‹è¯•

### è¿æ¥æ•°æ®åº“

```bash
# è¿æ¥ MySQLï¼ˆroot ç”¨æˆ·ï¼‰
docker exec -it miniblog-mysql mysql -u root -pj478EaZGDNPUbnXb

# è¿æ¥ MySQLï¼ˆåº”ç”¨ç”¨æˆ·ï¼‰
docker exec -it miniblog-mysql mysql -u miniblog_user -pj478EaZGDNPUbnXb miniblog

# è¿æ¥ Redis
docker exec -it miniblog-redis redis-cli -a weZ2014P89rlTuWe

# è¿›å…¥ Kafka å®¹å™¨
docker exec -it miniblog-kafka bash
```

### æœåŠ¡å¥åº·æ£€æŸ¥

```bash
# æ£€æŸ¥ MySQL æœåŠ¡çŠ¶æ€
docker exec miniblog-mysql mysqladmin ping -h localhost -u root -pj478EaZGDNPUbnXb

# æ£€æŸ¥ Redis æœåŠ¡çŠ¶æ€
docker exec miniblog-redis redis-cli -a weZ2014P89rlTuWe ping

# æ£€æŸ¥ Kafka æœåŠ¡çŠ¶æ€
docker exec miniblog-kafka kafka-topics --bootstrap-server localhost:9092 --list

# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨çŠ¶æ€
docker ps
```

### Kafka ä¸»é¢˜ç®¡ç†

```bash
# æŸ¥çœ‹ Kafka ä¸»é¢˜åˆ—è¡¨
docker exec miniblog-kafka kafka-topics --bootstrap-server localhost:9092 --list

# åˆ›å»ºæµ‹è¯•ä¸»é¢˜
docker exec miniblog-kafka kafka-topics --bootstrap-server localhost:9092 --create --topic test-topic --partitions 1 --replication-factor 1

# åˆ é™¤ä¸»é¢˜
docker exec miniblog-kafka kafka-topics --bootstrap-server localhost:9092 --delete --topic test-topic

# æŸ¥çœ‹ä¸»é¢˜è¯¦æƒ…
docker exec miniblog-kafka kafka-topics --bootstrap-server localhost:9092 --describe --topic test-topic
```

### ç®¡ç†ç•Œé¢è®¿é—®

```bash
# Kafka UI ç®¡ç†ç•Œé¢
open http://localhost:8080

# Kibana æ—¥å¿—åˆ†æç•Œé¢
open http://localhost:5601

# Grafana ç›‘æ§å¯è§†åŒ–ç•Œé¢ï¼ˆç”¨æˆ·å: admin, å¯†ç : admin123ï¼‰
open http://localhost:3000

# Jaeger é“¾è·¯è¿½è¸ªç•Œé¢
open http://localhost:16686

# Prometheus æŒ‡æ ‡æŸ¥è¯¢ç•Œé¢
open http://localhost:9090

# æˆ–åœ¨æµè§ˆå™¨ä¸­ç›´æ¥è®¿é—®å¯¹åº”åœ°å€
```

## âš™ï¸ é…ç½®ç®¡ç†

### ğŸ¯ æç®€é…ç½®åŸåˆ™

**ä¸€ä¸ªæ–‡ä»¶æå®šæ‰€æœ‰é…ç½®** - æ‰€æœ‰æœåŠ¡é…ç½®éƒ½é›†ä¸­åœ¨ `deploy/dev/docker-compose.env.yml` æ–‡ä»¶ä¸­ï¼š

- âœ… **ç¯å¢ƒå˜é‡**: è®¾ç½®åŸºæœ¬é…ç½®å‚æ•°
- âœ… **å¯åŠ¨å‘½ä»¤**: é€šè¿‡ `command` å‚æ•°è®¾ç½®è¯¦ç»†é…ç½®  
- âœ… **æ— å¤–éƒ¨æ–‡ä»¶**: ä¸ä¾èµ–é¢å¤–çš„é…ç½®æ–‡ä»¶
- âœ… **é›¶å­¦ä¹ æˆæœ¬**: åªéœ€è¦æŒæ¡ Docker Compose åŸºæœ¬å‘½ä»¤

### é…ç½®ä¿®æ”¹æ–¹æ³•

1. **ç¼–è¾‘é…ç½®æ–‡ä»¶**

   ```bash
   # ç¼–è¾‘ä¸»é…ç½®æ–‡ä»¶
   vi deploy/dev/docker-compose.env.yml
   ```

2. **é‡å¯æœåŠ¡**

   ```bash
   # é‡å¯æ‰€æœ‰æœåŠ¡
   docker compose -f docker-compose.env.yml restart
   
   # é‡å¯ç‰¹å®šæœåŠ¡
   docker compose -f docker-compose.env.yml restart mysql
   docker compose -f docker-compose.env.yml restart redis
   docker compose -f docker-compose.env.yml restart kafka
   ```

### å¸¸è§é…ç½®ä¿®æ”¹

#### ä¿®æ”¹å¯†ç 

```yaml
# MySQL å¯†ç ä¿®æ”¹
environment:
  MYSQL_ROOT_PASSWORD: æ–°å¯†ç 
  MYSQL_PASSWORD: æ–°å¯†ç 
command: >
  --default-authentication-plugin=mysql_native_password
  # ... å…¶ä»–é…ç½®

# Redis å¯†ç ä¿®æ”¹  
command: >
  redis-server
  --requirepass æ–°å¯†ç 
  # ... å…¶ä»–é…ç½®
```

#### è°ƒæ•´æ€§èƒ½å‚æ•°

```yaml
# MySQL æ€§èƒ½è°ƒä¼˜
command: >
  --max-connections=500          # å¢åŠ è¿æ¥æ•°
  --innodb-buffer-pool-size=512M # å¢åŠ ç¼“å†²æ± 
  
# Redis æ€§èƒ½è°ƒä¼˜
command: >
  redis-server
  --maxmemory 512mb              # å¢åŠ å†…å­˜é™åˆ¶
  --maxclients 20000             # å¢åŠ å®¢æˆ·ç«¯æ•°
```

## ğŸŒ ç½‘ç»œé…ç½®

### ğŸ—ï¸ ç½‘ç»œæ¶æ„è®¾è®¡

é¡¹ç›®é‡‡ç”¨**åˆ†å±‚ç½‘ç»œæ¶æ„**ï¼Œæ‰€æœ‰æœåŠ¡è¿è¡Œåœ¨åŒä¸€ä¸ª Docker ç½‘ç»œä¸­ï¼š

#### ç½‘ç»œç®¡ç†æ–¹å¼

1. **æ‰‹åŠ¨åˆ›å»ºå¤–éƒ¨ç½‘ç»œ** â†’ `miniblog-network`
2. **åŸºç¡€ç¯å¢ƒ** (`docker-compose.env.yml`) â†’ ä½¿ç”¨å¤–éƒ¨ç½‘ç»œ
3. **åº”ç”¨æœåŠ¡** (`docker-compose.yml`) â†’ ä½¿ç”¨å¤–éƒ¨ç½‘ç»œ

æ‰€æœ‰æœåŠ¡éƒ½è¿æ¥åˆ°åŒä¸€ä¸ªé¢„å…ˆåˆ›å»ºçš„å¤–éƒ¨ç½‘ç»œï¼Œç¡®ä¿å®Œå…¨çš„ç½‘ç»œè¿é€šæ€§ã€‚

#### æœåŠ¡ç½‘ç»œè®¿é—®

æ‰€æœ‰æœåŠ¡éƒ½åœ¨ `miniblog-network` ç½‘ç»œä¸­ï¼ŒæœåŠ¡é—´é€šè¿‡å®¹å™¨åè®¿é—®ï¼š

**åŸºç¡€æœåŠ¡**:

- **MySQL**: `mysql:3306`
- **Redis**: `redis:6379`  
- **Kafka**: `kafka:29092`

- **Zookeeper**: `zookeeper:2181`

**å¯è§‚æµ‹æ€§æœåŠ¡**:

- **Elasticsearch**: `elasticsearch:9200`

- **Prometheus**: `prometheus:9090`
- **Jaeger**: `jaeger:14268` (collector)

**åº”ç”¨æœåŠ¡**:

- **User API**: `user-api:8888`
- **User RPC**: `user-rpc:8889`
- **Nginx**: `nginx:8099`

### åº”ç”¨é…ç½®ç¤ºä¾‹

```yaml
# åº”ç”¨é…ç½®æ–‡ä»¶ç¤ºä¾‹
database:
  host: mysql
  port: 3306
  username: miniblog_user
  password: j478EaZGDNPUbnXb
  database: miniblog

redis:
  host: redis
  port: 6379
  password: weZ2014P89rlTuWe

kafka:
  brokers:
    - kafka:29092

# å¯è§‚æµ‹æ€§é…ç½®
telemetry:
  # æŒ‡æ ‡æ”¶é›†
  metrics:
    enabled: true
    endpoint: http://prometheus:9090

  # é“¾è·¯è¿½è¸ª  
  tracing:
    enabled: true
    endpoint: http://jaeger:14268
    service_name: miniblog
    
  # æ—¥å¿—é…ç½®
  logging:
    level: info
    output: /var/log/app/app.log
    format: json
```

## ğŸ”§ æ•…éšœæ’é™¤

### 1. æœåŠ¡å¯åŠ¨å¤±è´¥

```bash
# æŸ¥çœ‹è¯¦ç»†å¯åŠ¨æ—¥å¿—
docker compose -f docker-compose.env.yml logs

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker compose -f docker-compose.env.yml logs mysql
docker compose -f docker-compose.env.yml logs redis
docker compose -f docker-compose.env.yml logs kafka

# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :3306   # MySQL
lsof -i :6379   # Redis
lsof -i :9092   # Kafka
lsof -i :8080   # Kafka UI
lsof -i :9200   # Elasticsearch
lsof -i :5601   # Kibana
lsof -i :9090   # Prometheus
lsof -i :3000   # Grafana
lsof -i :16686  # Jaeger

# æ£€æŸ¥ Docker çŠ¶æ€
docker info
```

### 2. æ•°æ®åº“è¿æ¥é—®é¢˜

```bash
# æ£€æŸ¥ MySQL æœåŠ¡çŠ¶æ€
docker exec miniblog-mysql mysqladmin ping -h localhost -u root -pj478EaZGDNPUbnXb

# æŸ¥çœ‹ MySQL é”™è¯¯æ—¥å¿—
docker logs miniblog-mysql

# æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å­˜åœ¨
docker exec miniblog-mysql mysql -u root -pj478EaZGDNPUbnXb -e "SHOW DATABASES;"
```

### 3. Redis è¿æ¥é—®é¢˜

```bash
# æ£€æŸ¥ Redis æœåŠ¡çŠ¶æ€
docker exec miniblog-redis redis-cli -a weZ2014P89rlTuWe ping

# æŸ¥çœ‹ Redis é…ç½®
docker exec miniblog-redis redis-cli -a weZ2014P89rlTuWe CONFIG GET "*"

# æŸ¥çœ‹ Redis æ—¥å¿—
docker logs miniblog-redis
```

### 4. Kafka è¿æ¥é—®é¢˜

```bash
# æ£€æŸ¥ Kafka æœåŠ¡çŠ¶æ€
docker exec miniblog-kafka kafka-topics --bootstrap-server localhost:9092 --list

# æŸ¥çœ‹ Zookeeper çŠ¶æ€
docker exec miniblog-zookeeper zkServer.sh status

# æŸ¥çœ‹ Kafka æ—¥å¿—
docker logs miniblog-kafka
```

### 5. å¯è§‚æµ‹æ€§ç»„ä»¶é—®é¢˜

```bash
# æ£€æŸ¥ Elasticsearch çŠ¶æ€
curl -X GET "localhost:9200/_cluster/health"

# æ£€æŸ¥ Prometheus çŠ¶æ€
curl http://localhost:9090/-/healthy

# æŸ¥çœ‹ Grafana æ—¥å¿—
docker logs miniblog-grafana

# æŸ¥çœ‹ Jaeger æ—¥å¿—
docker logs miniblog-jaeger

# æŸ¥çœ‹ Filebeat çŠ¶æ€
docker logs miniblog-filebeat
```

### 6. ç½‘ç»œè¿æ¥é—®é¢˜

```bash
# æ£€æŸ¥ç½‘ç»œçŠ¶æ€
docker network ls

# æ£€æŸ¥ dev_miniblog-network ç½‘ç»œè¯¦æƒ…
docker network inspect dev_miniblog-network

# ç¡®è®¤åŸºç¡€ç¯å¢ƒç½‘ç»œæ˜¯å¦åˆ›å»º
docker compose -f docker-compose.env.yml ps

# å¦‚æœåº”ç”¨æœåŠ¡æ— æ³•å¯åŠ¨ï¼Œæ£€æŸ¥ç½‘ç»œæ˜¯å¦å­˜åœ¨
docker network ls | grep miniblog

# æµ‹è¯•å®¹å™¨é—´è¿é€šæ€§ï¼ˆåŸºç¡€ç¯å¢ƒå†…ï¼‰
docker exec miniblog-mysql ping redis
docker exec miniblog-redis ping kafka
docker exec miniblog-elasticsearch ping prometheus

# æµ‹è¯•åº”ç”¨æœåŠ¡ä¸åŸºç¡€æœåŠ¡çš„è¿é€šæ€§ï¼ˆéœ€è¦ä¸¤ä¸ªç¯å¢ƒéƒ½å¯åŠ¨ï¼‰
docker exec miniblog-user-api ping mysql
docker exec miniblog-user-rpc ping redis
```

### 7. å¯åŠ¨é¡ºåºé—®é¢˜

```bash
# é”™è¯¯ï¼šå¦‚æœå…ˆå¯åŠ¨åº”ç”¨æœåŠ¡ä¼šæŠ¥ç½‘ç»œä¸å­˜åœ¨é”™è¯¯
# Error: network dev_miniblog-network not found

# è§£å†³æ–¹æ¡ˆï¼šæŒ‰æ­£ç¡®é¡ºåºå¯åŠ¨
# 1. åœæ­¢æ‰€æœ‰æœåŠ¡
make dev-stop
make env-stop

# 2. æŒ‰é¡ºåºé‡æ–°å¯åŠ¨
make env-start    # å…ˆå¯åŠ¨åŸºç¡€ç¯å¢ƒ
sleep 30          # ç­‰å¾…åŸºç¡€æœåŠ¡å°±ç»ª
make dev          # å†å¯åŠ¨åº”ç”¨æœåŠ¡
```

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

### å¼€å‘ç¯å¢ƒå®‰å…¨

å½“å‰é…ç½®é€‚ç”¨äºå¼€å‘ç¯å¢ƒï¼ŒåŒ…å«ä»¥ä¸‹å®‰å…¨æªæ–½ï¼š

- Redis è®¾ç½®äº†è®¿é—®å¯†ç 
- MySQL åˆ›å»ºäº†ä¸“ç”¨åº”ç”¨ç”¨æˆ·
- ç®¡ç†ç•Œé¢è®¾ç½®äº†è®¿é—®æ§åˆ¶

### ç”Ÿäº§ç¯å¢ƒå»ºè®®

âš ï¸ **ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ—¶è¯·æ³¨æ„**ï¼š

1. **å¯†ç å®‰å…¨**
   - ä½¿ç”¨å¼ºå¯†ç ï¼ˆ16ä½ä»¥ä¸Šï¼ŒåŒ…å«å¤§å°å†™ã€æ•°å­—ã€ç‰¹æ®Šå­—ç¬¦ï¼‰
   - å®šæœŸæ›´æ¢å¯†ç 
   - ä½¿ç”¨å¯†é’¥ç®¡ç†ç³»ç»Ÿ

2. **ç½‘ç»œå®‰å…¨**
   - ä¸è¦æš´éœ²ä¸å¿…è¦çš„ç«¯å£
   - ä½¿ç”¨é˜²ç«å¢™é™åˆ¶è®¿é—®
   - å¯ç”¨ SSL/TLS åŠ å¯†

3. **è®¿é—®æ§åˆ¶**
   - é…ç½® Kafka SASL è®¤è¯
   - é™åˆ¶ç®¡ç†ç•Œé¢è®¿é—® IP
   - ä½¿ç”¨ VPN æˆ–è·³æ¿æœº

4. **æ•°æ®å®‰å…¨**
   - å®šæœŸå¤‡ä»½æ•°æ®
   - å¯ç”¨æ•°æ®åŠ å¯†
   - è®¾ç½®æ•°æ®ä¿ç•™ç­–ç•¥

## ğŸ› ï¸ é«˜çº§æ“ä½œ

### æ•°æ®å¤‡ä»½ä¸æ¢å¤

```bash
# å¤‡ä»½ MySQL æ•°æ®åº“
docker exec miniblog-mysql mysqldump -u root -pj478EaZGDNPUbnXb miniblog > backup_$(date +%Y%m%d_%H%M%S).sql

# æ¢å¤ MySQL æ•°æ®åº“
docker exec -i miniblog-mysql mysql -u root -pj478EaZGDNPUbnXb miniblog < backup_20250815_120000.sql

# å¤‡ä»½ Redis æ•°æ®
docker exec miniblog-redis redis-cli -a weZ2014P89rlTuWe BGSAVE
echo "Redis æ•°æ®å·²å¤‡ä»½åˆ°å®¹å™¨å†…çš„ /data/dump.rdb"

# å¯¼å‡º Redis æ•°æ®åˆ°æœ¬åœ°
docker cp miniblog-redis:/data/dump.rdb ./redis_backup_$(date +%Y%m%d_%H%M%S).rdb
```

### ç¯å¢ƒé‡ç½®

```bash
# å®Œå…¨é‡ç½®ç¯å¢ƒï¼ˆä¼šåˆ é™¤æ‰€æœ‰æ•°æ®ï¼‰
docker compose -f docker-compose.env.yml down -v

# æ¸…ç†ç³»ç»Ÿèµ„æº
docker system prune -f

# æ¸…ç†æœªä½¿ç”¨çš„é•œåƒ
docker image prune -f

# æ¸…ç†æœªä½¿ç”¨çš„æ•°æ®å·
docker volume prune -f
```

### ç›‘æ§å’Œè°ƒè¯•

```bash
# æŸ¥çœ‹èµ„æºä½¿ç”¨æƒ…å†µ
docker stats --no-stream

# æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯
docker inspect miniblog-mysql
docker inspect miniblog-redis
docker inspect miniblog-kafka

# æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯
docker system df
docker version
docker info
```

## ğŸ“š ç›¸å…³èµ„æº

### å®˜æ–¹æ–‡æ¡£

- [MySQL 8.0 å®˜æ–¹æ–‡æ¡£](https://dev.mysql.com/doc/refman/8.0/en/)
- [Redis å®˜æ–¹æ–‡æ¡£](https://redis.io/documentation)
- [Apache Kafka å®˜æ–¹æ–‡æ¡£](https://kafka.apache.org/documentation/)
- [Docker Compose å®˜æ–¹æ–‡æ¡£](https://docs.docker.com/compose/)

### ç®¡ç†å·¥å…·

- [Kafka UI](https://github.com/provectus/kafka-ui) - Kafka ç®¡ç†ç•Œé¢

### å­¦ä¹ èµ„æº

- [Docker å…¥é—¨æ•™ç¨‹](https://docs.docker.com/get-started/)
- [MySQL æ€§èƒ½ä¼˜åŒ–æŒ‡å—](https://dev.mysql.com/doc/refman/8.0/en/optimization.html)
- [Redis æœ€ä½³å®è·µ](https://redis.io/docs/manual/patterns/)
- [Kafka è®¾è®¡åŸç†](https://kafka.apache.org/intro)

## ğŸ¯ æ€»ç»“

âœ¨ **å®Œæ•´çš„å¾®æœåŠ¡å¼€å‘ç¯å¢ƒæ­å»ºå®Œæˆï¼**

### ğŸ—ï¸ å®Œæ•´æŠ€æœ¯æ ˆ

#### åŸºç¡€æœåŠ¡

- **MySQL 8.0**: å…³ç³»å‹æ•°æ®åº“
- **Redis 7**: å†…å­˜ç¼“å­˜
- **Kafka 7.4.0**: æ¶ˆæ¯é˜Ÿåˆ—

#### å¯è§‚æµ‹æ€§å¥—ä»¶  

- **ğŸ“Š æŒ‡æ ‡ç›‘æ§**: Prometheus + Grafana
- **ğŸ“ æ—¥å¿—åˆ†æ**: ELK Stack (Elasticsearch + Kibana) + Filebeat + go-stash
- **ğŸ” é“¾è·¯è¿½è¸ª**: Jaeger

### ğŸ¨ ä¼˜åŠ¿ç‰¹ç‚¹

- ğŸš€ **ä¸€æ¡å‘½ä»¤å¯åŠ¨**: `docker compose -f docker-compose.env.yml up -d`
- ğŸ“ **å•æ–‡ä»¶é…ç½®**: æ‰€æœ‰é…ç½®é›†ä¸­åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­
- ğŸ”§ **é›¶ä¾èµ–**: æ— éœ€é¢å¤–çš„è„šæœ¬ã€Makefile æˆ–é…ç½®æ–‡ä»¶
- ğŸ“š **å­¦ä¹ æˆæœ¬ä½**: åªéœ€æŒæ¡åŸºæœ¬çš„ Docker Compose å‘½ä»¤
- ğŸ› ï¸ **ç»´æŠ¤ç®€å•**: ä¿®æ”¹é…ç½®åªéœ€ç¼–è¾‘ä¸€ä¸ªæ–‡ä»¶
- ğŸ‘ï¸ **å®Œæ•´å¯è§‚æµ‹æ€§**: æŒ‡æ ‡ã€æ—¥å¿—ã€è¿½è¸ªä¸‰å¤§æ”¯æŸ±å…¨è¦†ç›–

### ä¸‹ä¸€æ­¥

ç¯å¢ƒæ­å»ºå®Œæˆåï¼Œæ‚¨å¯ä»¥ï¼š

1. **å¼€å‘åº”ç”¨**: ä½¿ç”¨é…ç½®å¥½çš„æ•°æ®åº“å’Œæ¶ˆæ¯é˜Ÿåˆ—
2. **æ€§èƒ½æµ‹è¯•**: åœ¨æœ¬åœ°ç¯å¢ƒè¿›è¡Œå‹åŠ›æµ‹è¯•  
3. **åŠŸèƒ½æµ‹è¯•**: éªŒè¯å„é¡¹åŠŸèƒ½çš„å®Œæ•´æ€§
4. **éƒ¨ç½²å‡†å¤‡**: ä¸ºç”Ÿäº§ç¯å¢ƒéƒ¨ç½²åšå‡†å¤‡
